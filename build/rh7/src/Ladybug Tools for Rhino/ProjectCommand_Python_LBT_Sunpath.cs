using System;

using Rhino.Commands;

namespace RhinoCodePlatform.Rhino3D.Projects.Plugin
{
  [CommandStyle(Rhino.Commands.Style.ScriptRunner)]
  public class ProjectCommand_Python_LBT_Sunpath  : Command
  {
    Rhino.Runtime.PythonScript _script;
    Rhino.Runtime.PythonCompiledCode _compiledCode;

    public Guid CommandId { get; } = new Guid("0566725e-a8ae-4419-8d94-4d0c6910c256");

    public override string EnglishName => "LBT_Sunpath";

    protected override Rhino.Commands.Result RunCommand(Rhino.RhinoDoc doc, Rhino.Commands.RunMode mode)
    {
      if (_compiledCode is null)
      {
        ProjectLibs.InitPythonLibraries();

        _script = Rhino.Runtime.PythonScript.Create();
        _compiledCode = _script.Compile(
            ProjectPlugin.DecryptString("IyEgcHl0aG9uIDINCmltcG9ydCBvcw0KaW1wb3J0IG1hdGgNCg0KdHJ5Og0KICAgIGZyb20gbGFkeWJ1Z19nZW9tZXRyeS5nZW9tZXRyeTJkIGltcG9ydCBQb2ludDJEDQogICAgZnJvbSBsYWR5YnVnX2dlb21ldHJ5Lmdlb21ldHJ5M2QgaW1wb3J0IFBvaW50M0QsIFZlY3RvcjNEDQpleGNlcHQgSW1wb3J0RXJyb3IgYXMgZToNCiAgICByYWlzZSBJbXBvcnRFcnJvcignXG5GYWlsZWQgdG8gaW1wb3J0IGxhZHlidWdfZ2VvbWV0cnk6XG5cdHt9Jy5mb3JtYXQoZSkpDQoNCnRyeToNCiAgICBmcm9tIGxhZHlidWcuZnV0aWwgaW1wb3J0IHVuemlwX2ZpbGUNCiAgICBmcm9tIGxhZHlidWcuY29uZmlnIGltcG9ydCBmb2xkZXJzDQogICAgZnJvbSBsYWR5YnVnLmR0IGltcG9ydCBEYXRlVGltZQ0KICAgIGZyb20gbGFkeWJ1Zy5lcHcgaW1wb3J0IEVQVw0KICAgIGZyb20gbGFkeWJ1Zy5zdW5wYXRoIGltcG9ydCBTdW5wYXRoDQpleGNlcHQgSW1wb3J0RXJyb3IgYXMgZToNCiAgICByYWlzZSBJbXBvcnRFcnJvcignXG5GYWlsZWQgdG8gaW1wb3J0IGxhZHlidWc6XG5cdHt9Jy5mb3JtYXQoZSkpDQoNCnRyeToNCiAgICBmcm9tIGxhZHlidWdfcmhpbm8uZG93bmxvYWQgaW1wb3J0IGRvd25sb2FkX2ZpbGUNCiAgICBmcm9tIGxhZHlidWdfcmhpbm8uY29uZmlnIGltcG9ydCBjb252ZXJzaW9uX3RvX21ldGVycw0KICAgIGZyb20gbGFkeWJ1Z19yaGluby5wcmV2aWV3IGltcG9ydCBWaXN1YWxpemF0aW9uU2V0Q29uZHVpdA0KICAgIGZyb20gbGFkeWJ1Z19yaGluby50b2dlb21ldHJ5IGltcG9ydCB0b19wb2ludDNkDQogICAgZnJvbSBsYWR5YnVnX3JoaW5vLmZyb21nZW9tZXRyeSBpbXBvcnQgZnJvbV9wb2ludDNkDQogICAgZnJvbSBsYWR5YnVnX3JoaW5vLmJha2VvYmplY3RzIGltcG9ydCBiYWtlX3Zpc3VhbGl6YXRpb25fc2V0DQpleGNlcHQgSW1wb3J0RXJyb3IgYXMgZToNCiAgICByYWlzZSBJbXBvcnRFcnJvcignXG5GYWlsZWQgdG8gaW1wb3J0IGxhZHlidWdfcmhpbm86XG5cdHt9Jy5mb3JtYXQoZSkpDQoNCmltcG9ydCBSaGlubw0KaW1wb3J0IHJoaW5vc2NyaXB0c3ludGF4IGFzIHJzDQppbXBvcnQgc2NyaXB0Y29udGV4dCBhcyBzYw0KDQoNCmRlZiBydW5fc3VucGF0aF9jb21tYW5kKCk6DQogICAgIyBnZXQgdGhlIEVQVyBmcm9tIGNvbW1hbmQgbGluZQ0KICAgIGdlcHcgPSBSaGluby5JbnB1dC5DdXN0b20uR2V0U3RyaW5nKCkNCiAgICBnZXB3LlNldENvbW1hbmRQcm9tcHQoJ1NlbGVjdCBhbiBFUFcgZmlsZSBwYXRoIG9yIFVSTCcpDQogICAgZXB3X3BhdGggPSBOb25lDQogICAgaWYgJ2xidF9lcHcnIGluIHNjLnN0aWNreToNCiAgICAgICAgZXB3X3BhdGggPSBzYy5zdGlja3lbJ2xidF9lcHcnXQ0KICAgICAgICBnZXB3LlNldERlZmF1bHRTdHJpbmcoZXB3X3BhdGgpDQoNCiAgICAjIGFkZCBhbGwgb2YgdGhlIG9wdGlvbnMgdG8gdGhlIGNvbW1hbmQNCiAgICBub3J0aF8gPSBzYy5zdGlja3lbJ2xidF9ub3J0aCddIGlmICdsYnRfbm9ydGgnIGluIHNjLnN0aWNreSBlbHNlIDANCiAgICBub3J0aF9vcHRpb24gPSBSaGluby5JbnB1dC5DdXN0b20uT3B0aW9uRG91YmxlKG5vcnRoXywgMCwgMzYwKQ0KICAgIGdlcHcuQWRkT3B0aW9uRG91YmxlKCdOb3J0aCcsIG5vcnRoX29wdGlvbikNCg0KICAgIHNjYWxlXyA9IHNjLnN0aWNreVsnbGJ0X3N1bnBhdGhfc2NhbGUnXSBpZiAnbGJ0X3N1bnBhdGhfc2NhbGUnIGluIHNjLnN0aWNreSBlbHNlIDENCiAgICBzY2FsZV9vcHRpb24gPSBSaGluby5JbnB1dC5DdXN0b20uT3B0aW9uRG91YmxlKHNjYWxlXywgVHJ1ZSwgMCkNCiAgICBnZXB3LkFkZE9wdGlvbkRvdWJsZSgnU2NhbGUnLCBzY2FsZV9vcHRpb24pDQoNCiAgICBwcm9qZWN0aW9uX2lfID0gc2Muc3RpY2t5WydsYnRfc3VucGF0aF9wcm9qZWN0aW9uJ10gXA0KICAgICAgICBpZiAnbGJ0X3N1bnBhdGhfcHJvamVjdGlvbicgaW4gc2Muc3RpY2t5IGVsc2UgMA0KICAgIHByb2plY3Rpb25zID0gKCczRCcsICdTdGVyZW9HcmFwaGljJywgJ09ydGhvZ3JhcGhpYycpDQogICAgcHJval9saXN0ID0gZ2Vwdy5BZGRPcHRpb25MaXN0KCdQcm9qZWN0aW9uJywgcHJvamVjdGlvbnMsIHByb2plY3Rpb25faV8pDQoNCiAgICBzb2xhcl90aW1lXyA9IHNjLnN0aWNreVsnbGJ0X3N1bnBhdGhfc29sYXJfdGltZSddIFwNCiAgICAgICAgaWYgJ2xidF9zdW5wYXRoX3NvbGFyX3RpbWUnIGluIHNjLnN0aWNreSBlbHNlIEZhbHNlDQogICAgc29sYXJfdGltZV9vcHRpb24gPSBSaGluby5JbnB1dC5DdXN0b20uT3B0aW9uVG9nZ2xlKHNvbGFyX3RpbWVfLCAnTm8nLCAnWWVzJykNCiAgICBnZXB3LkFkZE9wdGlvblRvZ2dsZSgnU29sYXJUaW1lJywgc29sYXJfdGltZV9vcHRpb24pDQoNCiAgICBlcHdfZGF0YV9pXyA9IHNjLnN0aWNreVsnbGJ0X3N1bnBhdGhfZGF0YSddIFwNCiAgICAgICAgaWYgJ2xidF9zdW5wYXRoX2RhdGEnIGluIHNjLnN0aWNreSBlbHNlIDANCiAgICBlcHdfZGF0YV9zZXRzID0gKA0KICAgICAgICAnTm9uZScsICdkcnlfYnVsYl90ZW1wZXJhdHVyZScsICdkZXdfcG9pbnRfdGVtcGVyYXR1cmUnLCAncmVsYXRpdmVfaHVtaWRpdHknLA0KICAgICAgICAnd2luZF9zcGVlZCcsICd3aW5kX2RpcmVjdGlvbicsICdkaXJlY3Rfbm9ybWFsX3JhZGlhdGlvbicsDQogICAgICAgICdkaWZmdXNlX2hvcml6b250YWxfcmFkaWF0aW9uJywgJ2dsb2JhbF9ob3Jpem9udGFsX3JhZGlhdGlvbicNCiAgICApDQogICAgZXB3X2RhdGFfbGlzdCA9IGdlcHcuQWRkT3B0aW9uTGlzdCgnRGF0YScsIGVwd19kYXRhX3NldHMsIGVwd19kYXRhX2lfKQ0KDQogICAgIyBnZXQgdGhlIHdlYXRoZXIgZmlsZSBhbmQgYWxsIG9wdGlvbnMNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICAjIFRoaXMgd2lsbCBwcm9tcHQgdGhlIHVzZXIgdG8gaW5wdXQgYW4gRVBXIGFuZCB2aXN1YWxpemF0aW9uIG9wdGlvbnMNCiAgICAgICAgZ2V0X2VwdyA9IGdlcHcuR2V0KCkNCiAgICAgICAgaWYgZ2V0X2VwdyA9PSBSaGluby5JbnB1dC5HZXRSZXN1bHQuU3RyaW5nOg0KICAgICAgICAgICAgZXB3X3BhdGggPSBnZXB3LlN0cmluZ1Jlc3VsdCgpDQogICAgICAgICAgICBub3J0aF8gPSBub3J0aF9vcHRpb24uQ3VycmVudFZhbHVlDQogICAgICAgICAgICBzY2FsZV8gPSBzY2FsZV9vcHRpb24uQ3VycmVudFZhbHVlDQogICAgICAgICAgICBzb2xhcl90aW1lXyA9IHNvbGFyX3RpbWVfb3B0aW9uLkN1cnJlbnRWYWx1ZQ0KICAgICAgICBlbGlmIGdldF9lcHcgPT0gUmhpbm8uSW5wdXQuR2V0UmVzdWx0Lk9wdGlvbjoNCiAgICAgICAgICAgIGlmIGdlcHcuT3B0aW9uSW5kZXgoKSA9PSBwcm9qX2xpc3Q6DQogICAgICAgICAgICAgICAgcHJvamVjdGlvbl9pXyA9IGdlcHcuT3B0aW9uKCkuQ3VycmVudExpc3RPcHRpb25JbmRleA0KICAgICAgICAgICAgaWYgZ2Vwdy5PcHRpb25JbmRleCgpID09IGVwd19kYXRhX2xpc3Q6DQogICAgICAgICAgICAgICAgZXB3X2RhdGFfaV8gPSBnZXB3Lk9wdGlvbigpLkN1cnJlbnRMaXN0T3B0aW9uSW5kZXgNCiAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIGJyZWFrDQoNCiAgICAjIHNhdmUgYWxsIG9mIHRoZSBvcHRpb25zIHRvIHN0aWNreQ0KICAgIHNjLnN0aWNreVsnbGJ0X25vcnRoJ10gPSBub3J0aF8NCiAgICBzYy5zdGlja3lbJ2xidF9zdW5wYXRoX3NjYWxlJ10gPSBzY2FsZV8NCiAgICBzYy5zdGlja3lbJ2xidF9zdW5wYXRoX3Byb2plY3Rpb24nXSA9IHByb2plY3Rpb25faV8NCiAgICBzYy5zdGlja3lbJ2xidF9zdW5wYXRoX3NvbGFyX3RpbWUnXSA9IHNvbGFyX3RpbWVfDQogICAgc2Muc3RpY2t5WydsYnRfc3VucGF0aF9kYXRhJ10gPSBlcHdfZGF0YV9pXw0KDQogICAgIyBwcm9jZXNzIHRoZSBFUFcgZmlsZSBwYXRoIG9yIFVSTA0KICAgIGlmIG5vdCBlcHdfcGF0aDoNCiAgICAgICAgcmV0dXJuDQogICAgX2RlZl9mb2xkZXIgPSBmb2xkZXJzLmRlZmF1bHRfZXB3X2ZvbGRlcg0KICAgIGlmIGVwd19wYXRoLnN0YXJ0c3dpdGgoJ2h0dHAnKTogICMgZG93bmxvYWQgdGhlIEVQVyBmaWxlDQogICAgICAgIF93ZWF0aGVyX1VSTCA9IGVwd19wYXRoDQogICAgICAgIGlmIF93ZWF0aGVyX1VSTC5sb3dlcigpLmVuZHN3aXRoKCcuemlwJyk6ICAjIG9uZWJ1aWxkaW5nIFVSTCB0eXBlDQogICAgICAgICAgICBfZm9sZGVyX25hbWUgPSBfd2VhdGhlcl9VUkwuc3BsaXQoJy8nKVstMV1bOi00XQ0KICAgICAgICBlbHNlOiAgIyBkZXB0IG9mIGVuZXJneSBVUkwgdHlwZQ0KICAgICAgICAgICAgX2ZvbGRlcl9uYW1lID0gX3dlYXRoZXJfVVJMLnNwbGl0KCcvJylbLTJdDQogICAgICAgIGVwd19wYXRoID0gb3MucGF0aC5qb2luKF9kZWZfZm9sZGVyLCBfZm9sZGVyX25hbWUsIF9mb2xkZXJfbmFtZSArICcuZXB3JykNCiAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKGVwd19wYXRoKToNCiAgICAgICAgICAgIHppcF9maWxlX3BhdGggPSBvcy5wYXRoLmpvaW4oX2RlZl9mb2xkZXIsIF9mb2xkZXJfbmFtZSwgX2ZvbGRlcl9uYW1lICsgJy56aXAnKQ0KICAgICAgICAgICAgZG93bmxvYWRfZmlsZShfd2VhdGhlcl9VUkwsIHppcF9maWxlX3BhdGgsIFRydWUpDQogICAgICAgICAgICB1bnppcF9maWxlKHppcF9maWxlX3BhdGgpDQogICAgICAgIHNjLnN0aWNreVsnbGJ0X2VwdyddID0gb3MucGF0aC5iYXNlbmFtZShlcHdfcGF0aCkNCiAgICBlbGlmIG5vdCBvcy5wYXRoLmlzZmlsZShlcHdfcGF0aCk6DQogICAgICAgIHBvc3NpYmxlX2ZpbGUgPSBvcy5wYXRoLmJhc2VuYW1lKGVwd19wYXRoKVs6LTRdIFwNCiAgICAgICAgICAgIGlmIGVwd19wYXRoLmxvd2VyKCkuZW5kc3dpdGgoJy5lcHcnKSBlbHNlIGVwd19wYXRoDQogICAgICAgIGVwd19wYXRoID0gb3MucGF0aC5qb2luKF9kZWZfZm9sZGVyLCBwb3NzaWJsZV9maWxlLCBwb3NzaWJsZV9maWxlICsgJy5lcHcnKQ0KICAgICAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUoZXB3X3BhdGgpOg0KICAgICAgICAgICAgcHJpbnQoJ1NlbGVjdGVkIEVQVyBmaWxlIGF0IGRvZXMgbm90IGV4aXN0IGF0OiB7fScuZm9ybWF0KGVwd19wYXRoKSkNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICBzYy5zdGlja3lbJ2xidF9lcHcnXSA9IHBvc3NpYmxlX2ZpbGUgKyAnLmVwdycNCiAgICBlbHNlOg0KICAgICAgICBzYy5zdGlja3lbJ2xidF9lcHcnXSA9IGVwd19wYXRoDQoNCiAgICAjIHByb2Nlc3MgYWxsIG9mIHRoZSBnbG9iYWwgaW5wdXRzIGZvciB0aGUgc3VucGF0aA0KICAgIGNlbnRlcl9wdDNkID0gc2Muc3RpY2t5WydsYnRfb3JpZ2luJ10gaWYgJ2xidF9vcmlnaW4nIGluIHNjLnN0aWNreSBlbHNlIFBvaW50M0QoKQ0KICAgIHJhZGl1cyA9ICgxMDAgKiBzY2FsZV8pIC8gY29udmVyc2lvbl90b19tZXRlcnMoKQ0KICAgIGRhaWx5XyA9IEZhbHNlDQogICAgcHJvamVjdGlvbl8gPSBwcm9qZWN0aW9uc1twcm9qZWN0aW9uX2lfXSBpZiBwcm9qZWN0aW9uX2lfICE9IDAgZWxzZSBOb25lDQoNCiAgICAjIGdldCB0aGUgbG9jYXRpb24gZnJvbSB0aGUgRVBXDQogICAgZXB3X29iaiA9IEVQVyhlcHdfcGF0aCkNCiAgICBfbG9jYXRpb24gPSBlcHdfb2JqLmxvY2F0aW9uDQoNCiAgICAjIHByb2Nlc3MgdGhlIEVQVyBkYXRhIHRvIGJlIHBsb3R0ZWQgb24gdGhlIGNoYXJ0IGlmIGl0IHdhcyByZXF1ZXN0ZWQNCiAgICBob3lzXywgZGF0YV8gPSBbXSwgW10NCiAgICBpZiBlcHdfZGF0YV9pXyAhPSAwOg0KICAgICAgICBkYXRhXy5hcHBlbmQoZ2V0YXR0cihlcHdfb2JqLCBlcHdfZGF0YV9zZXRzW2Vwd19kYXRhX2lfXSkpDQogICAgICAgIGZvciBtb250aCBpbiByYW5nZSgxLCAxMyk6DQogICAgICAgICAgICBmb3IgZGF5IGluIHJhbmdlKDEsIDI5LCA3KToNCiAgICAgICAgICAgICAgICBmb3IgaG91ciBpbiByYW5nZSgyNCk6DQogICAgICAgICAgICAgICAgICAgIGhveXNfLmFwcGVuZChEYXRlVGltZShtb250aCwgZGF5LCBob3VyKS5ob3kpDQoNCiAgICAjIG1ha2UgdGhlIHN1bnBhdGggdmlzdWFsaXphdGlvbiBzZXQNCiAgICBzcCA9IFN1bnBhdGguZnJvbV9sb2NhdGlvbihfbG9jYXRpb24sIG5vcnRoXykNCiAgICB2aXNfc2V0X2FyZ3MgPSBbaG95c18sIGRhdGFfLCBOb25lLCByYWRpdXMsIGNlbnRlcl9wdDNkLCBzb2xhcl90aW1lXywgZGFpbHlfLCBwcm9qZWN0aW9uX10NCiAgICB2aXNfc2V0ID0gc3AudG9fdmlzX3NldCgqdmlzX3NldF9hcmdzKQ0KDQogICAgIyBwcmV2aWV3IHRoZSB2aXN1YWxpemF0aW9uIHNldCBhbmQgYXNrIGlmIHRoZSBvcmlnaW4gc2hvdWxkIGJlIGNoYW5nZWQNCiAgICBjb25kdWl0ID0gVmlzdWFsaXphdGlvblNldENvbmR1aXQodmlzX3NldCwgcmVuZGVyXzNkX2xlZ2VuZD1UcnVlLCByZW5kZXJfMmRfbGVnZW5kPUZhbHNlKQ0KICAgIGNvbmR1aXQuRW5hYmxlZCA9IFRydWUNCiAgICBzYy5kb2MuVmlld3MuUmVkcmF3KCkNCiAgICBncCA9IFJoaW5vLklucHV0LkN1c3RvbS5HZXRQb2ludCgpDQogICAgZ3AuU2V0Q29tbWFuZFByb21wdCgnU2VsZWN0IGEgUG9pbnQgZm9yIHRoZSBvcmlnaW4gb3IgcHJlc3MgRU5URVIgdG8ga2VlcCB0aGUgY3VycmVudCBvbmUuJykNCiAgICBncC5TZXREZWZhdWx0UG9pbnQoZnJvbV9wb2ludDNkKGNlbnRlcl9wdDNkKSkNCiAgICBncC5HZXQoKQ0KICAgIGlmIGdwLkNvbW1hbmRSZXN1bHQoKSA9PSBSaGluby5Db21tYW5kcy5SZXN1bHQuU3VjY2VzczoNCiAgICAgICAgcG9pbnQgPSBncC5Qb2ludCgpDQogICAgICAgIG9yaWdpbiA9IHRvX3BvaW50M2QocG9pbnQpDQogICAgICAgIHZpc19zZXRfYXJnc1s0XSA9IG9yaWdpbg0KICAgICAgICBzYy5zdGlja3lbJ2xidF9vcmlnaW4nXSA9IG9yaWdpbg0KICAgICAgICB2aXNfc2V0ID0gc3AudG9fdmlzX3NldCgqdmlzX3NldF9hcmdzKQ0KICAgICAgICBjb25kdWl0LkVuYWJsZWQgPSBGYWxzZQ0KICAgICAgICBjb25kdWl0ID0gVmlzdWFsaXphdGlvblNldENvbmR1aXQodmlzX3NldCwgcmVuZGVyXzNkX2xlZ2VuZD1UcnVlLCByZW5kZXJfMmRfbGVnZW5kPUZhbHNlKQ0KICAgICAgICBjb25kdWl0LkVuYWJsZWQgPSBUcnVlDQogICAgICAgIHNjLmRvYy5WaWV3cy5SZWRyYXcoKQ0KDQogICAgIyBmaW5hbGx5LCBsZXQgcGVvcGxlIGRlY2lkZSB3aGF0IHRoZXkgd2FudCB0byBkbyB3aXRoIHRoZSByZXN1bHQNCiAgICBncmVzID0gUmhpbm8uSW5wdXQuQ3VzdG9tLkdldFN0cmluZygpDQogICAgZ3Jlcy5TZXRDb21tYW5kUHJvbXB0KCdXb3VsZCB5b3UgbGlrZSB0byBhZGQgdGhlIFN1bnBhdGggR2VvbWV0cnkgdG8gdGhlIERvY3VtZW50PyBIaXQgRU5URVIgd2hlbiBkb25lLicpDQogICAgZ3Jlcy5TZXREZWZhdWx0U3RyaW5nKCdBZGQ/JykNCiAgICBiYWtlX3Jlc3VsdCA9IEZhbHNlDQogICAgcmVzdWx0X29wdGlvbiA9IFJoaW5vLklucHV0LkN1c3RvbS5PcHRpb25Ub2dnbGUoRmFsc2UsICdObycsICdZZXMnKQ0KICAgIGdyZXMuQWRkT3B0aW9uVG9nZ2xlKCdBZGRUb0RvYycsIHJlc3VsdF9vcHRpb24pDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgIyBUaGlzIHdpbGwgcHJvbXB0IHRoZSB1c2VyIHRvIGlucHV0IGFuIEVQVyBhbmQgdmlzdWFsaXphdGlvbiBvcHRpb25zDQogICAgICAgIGdldF9yZXMgPSBncmVzLkdldCgpDQogICAgICAgIGlmIGdldF9yZXMgPT0gUmhpbm8uSW5wdXQuR2V0UmVzdWx0LlN0cmluZzoNCiAgICAgICAgICAgIGJha2VfcmVzdWx0ID0gcmVzdWx0X29wdGlvbi5DdXJyZW50VmFsdWUNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIGJyZWFrDQogICAgY29uZHVpdC5FbmFibGVkID0gRmFsc2UNCiAgICBzYy5kb2MuVmlld3MuUmVkcmF3KCkNCg0KICAgICMgYWRkIHRoZSB2aXN1YWxpemF0aW9uIHNldCB0byB0aGUgZG9jdW1lbnQNCiAgICBpZiBiYWtlX3Jlc3VsdDoNCiAgICAgICAgYmFrZV92aXN1YWxpemF0aW9uX3NldCh2aXNfc2V0LCBiYWtlXzNkX2xlZ2VuZD1UcnVlKQ0KDQoNCnJ1bl9zdW5wYXRoX2NvbW1hbmQoKQ0K")
          );
      }

      if (_compiledCode is null)
      {
        Rhino.RhinoApp.WriteLine("The script code for {0} could not be retrieved or compiled.", EnglishName);
        return Rhino.Commands.Result.Failure;
      }

      _script.ScriptContextDoc = doc;
      _script.SetVariable("__name__", "__main__");

      _compiledCode.Execute(_script);

      return Rhino.Commands.Result.Success;
    }
  }
}
